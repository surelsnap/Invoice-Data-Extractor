{"ast":null,"code":"var _jsxFileName = \"D:\\\\projects\\\\omdatta1\\\\omdatta\\\\frontend\\\\src\\\\components\\\\FileUpload.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport axios from 'axios';\nimport Results from './Results';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FileUpload = () => {\n  _s();\n  const [downloadLink, setDownloadLink] = useState('');\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const {\n    getRootProps,\n    getInputProps\n  } = useDropzone({\n    accept: {\n      'image/*': ['.jpeg', '.jpg', '.png'],\n      'application/pdf': ['.pdf']\n    },\n    maxFiles: 1,\n    multiple: false,\n    disabled: isLoading,\n    onDrop: files => handleFileUpload(files[0])\n  });\n  const handleFileUpload = async file => {\n    setIsLoading(true);\n    setError('');\n    setDownloadLink('');\n    setUploadProgress(0);\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      const response = await axios.post(process.env.REACT_APP_API_URL + '/upload', formData, {\n        responseType: 'blob',\n        onUploadProgress: progressEvent => {\n          const percentCompleted = Math.round(progressEvent.loaded * 100 / progressEvent.total);\n          setUploadProgress(percentCompleted);\n        },\n        timeout: 30000 // 30 seconds timeout\n      });\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      setDownloadLink(url);\n    } catch (err) {\n      let errorMessage = 'Failed to process invoice';\n      if (err.response) {\n        // Handle blob error responses\n        if (err.response.data instanceof Blob) {\n          const errorData = await new Response(err.response.data).json();\n          errorMessage = errorData.detail || errorMessage;\n        } else {\n          var _err$response$data;\n          errorMessage = ((_err$response$data = err.response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || errorMessage;\n        }\n      } else if (err.request) {\n        errorMessage = 'No response from server';\n      } else if (err.code === 'ECONNABORTED') {\n        errorMessage = 'Request timed out';\n      }\n      setError(errorMessage);\n\n      // Revoke any existing URL\n      if (downloadLink) {\n        window.URL.revokeObjectURL(downloadLink);\n        setDownloadLink('');\n      }\n    } finally {\n      setIsLoading(false);\n      setUploadProgress(0);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"file-upload-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ...getRootProps(),\n      className: `dropzone ${isLoading ? 'loading' : ''}`,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        ...getInputProps()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"upload-progress\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-bar\",\n          style: {\n            width: `${uploadProgress}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Processing: \", uploadProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"upload-prompt\",\n        children: [\"Drag & drop invoice file, or click to select\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n          children: \"(Supports PDF, JPG, PNG)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Results, {\n      downloadLink: downloadLink,\n      error: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n_s(FileUpload, \"i4z/Zfh83G8MdIKo6N2frXzDL0E=\", false, function () {\n  return [useDropzone];\n});\n_c = FileUpload;\nexport default FileUpload;\nvar _c;\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"names":["React","useState","useDropzone","axios","Results","jsxDEV","_jsxDEV","FileUpload","_s","downloadLink","setDownloadLink","error","setError","isLoading","setIsLoading","uploadProgress","setUploadProgress","getRootProps","getInputProps","accept","maxFiles","multiple","disabled","onDrop","files","handleFileUpload","file","formData","FormData","append","response","post","process","env","REACT_APP_API_URL","responseType","onUploadProgress","progressEvent","percentCompleted","Math","round","loaded","total","timeout","url","window","URL","createObjectURL","Blob","data","err","errorMessage","errorData","Response","json","detail","_err$response$data","message","request","code","revokeObjectURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","width","_c","$RefreshReg$"],"sources":["D:/projects/omdatta1/omdatta/frontend/src/components/FileUpload.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport axios from 'axios';\r\nimport Results from './Results';\r\n\r\nconst FileUpload = () => {\r\n  const [downloadLink, setDownloadLink] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n\r\n  const { getRootProps, getInputProps } = useDropzone({\r\n    accept: {\r\n      'image/*': ['.jpeg', '.jpg', '.png'],\r\n      'application/pdf': ['.pdf']\r\n    },\r\n    maxFiles: 1,\r\n    multiple: false,\r\n    disabled: isLoading,\r\n    onDrop: files => handleFileUpload(files[0])\r\n  });\r\n\r\n  const handleFileUpload = async file => {\r\n    setIsLoading(true);\r\n    setError('');\r\n    setDownloadLink('');\r\n    setUploadProgress(0);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n\r\n      const response = await axios.post(\r\n        process.env.REACT_APP_API_URL + '/upload',\r\n        formData,\r\n        { \r\n          responseType: 'blob',\r\n          onUploadProgress: progressEvent => {\r\n            const percentCompleted = Math.round(\r\n              (progressEvent.loaded * 100) / progressEvent.total\r\n            );\r\n            setUploadProgress(percentCompleted);\r\n          },\r\n          timeout: 30000 // 30 seconds timeout\r\n        }\r\n      );\r\n\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      setDownloadLink(url);\r\n    } catch (err) {\r\n      let errorMessage = 'Failed to process invoice';\r\n      \r\n      if (err.response) {\r\n        // Handle blob error responses\r\n        if (err.response.data instanceof Blob) {\r\n          const errorData = await new Response(err.response.data).json();\r\n          errorMessage = errorData.detail || errorMessage;\r\n        } else {\r\n          errorMessage = err.response.data?.message || errorMessage;\r\n        }\r\n      } else if (err.request) {\r\n        errorMessage = 'No response from server';\r\n      } else if (err.code === 'ECONNABORTED') {\r\n        errorMessage = 'Request timed out';\r\n      }\r\n\r\n      setError(errorMessage);\r\n      \r\n      // Revoke any existing URL\r\n      if (downloadLink) {\r\n        window.URL.revokeObjectURL(downloadLink);\r\n        setDownloadLink('');\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n      setUploadProgress(0);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"file-upload-container\">\r\n      <div\r\n        {...getRootProps()}\r\n        className={`dropzone ${isLoading ? 'loading' : ''}`}\r\n      >\r\n        <input {...getInputProps()} />\r\n        {isLoading ? (\r\n          <div className=\"upload-progress\">\r\n            <div className=\"progress-bar\" style={{ width: `${uploadProgress}%` }}></div>\r\n            <span>Processing: {uploadProgress}%</span>\r\n          </div>\r\n        ) : (\r\n          <p className=\"upload-prompt\">\r\n            Drag & drop invoice file, or click to select\r\n            <br />\r\n            <small>(Supports PDF, JPG, PNG)</small>\r\n          </p>\r\n        )}\r\n      </div>\r\n\r\n      <Results downloadLink={downloadLink} error={error} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FileUpload;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}